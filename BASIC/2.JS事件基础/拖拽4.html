<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<script>
window.onload=function ()
{
	var oDiv=document.getElementById('div');
	
	var disX=0;
	var disY=0;
	
	oDiv.onmousedown=function (ev)
	{
		var oEvent=ev||event;
		
		disX=oEvent.clientX-oDiv.offsetLeft;
		disY=oEvent.clientY-oDiv.offsetTop;
		
			document.onmousemove=function (ev)
			{
				var oEvent=ev||event;
				var L=oEvent.clientX-disX;
				var T=oEvent.clientY-disY
				
				if(L<0)
				{
					L=0;
				}
				else if(L>document.documentElement.clientWidth-oDiv.offsetWidth)
				{
					L=document.documentElement.clientWidth-oDiv.offsetWidth;
				};
				
				if(T<0)
				{
					T=0;
				}
				else if(T>document.documentElement.clientHeight-oDiv.offsetHeight)
				{
					T=document.documentElement.clientHeight-oDiv.offsetHeight;
				};
				
				oDiv.style.left=L+'px';
				oDiv.style.top=T+'px';
			};
			
			document.onmouseup=function ()
			{
				document.onmousemove=null;
				document.onmouseup=null;
			};
			
		return false;//屏蔽火狐下面的bug
	};
};
</script>

</head>

<body>
<div id="div" style="width:300px; height:200px; background:red; position:absolute;"></div>
</body>
</html>
